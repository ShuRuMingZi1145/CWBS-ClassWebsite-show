class EnhancedUnitConverter{constructor(){this.categories={length:{name:"é•¿åº¦",units:{"ç±³":{factor:1,symbol:"m"},"åƒç±³":{factor:.001,symbol:"km"},"å˜ç±³":{factor:100,symbol:"cm"},"æ¯«ç±³":{factor:1e3,symbol:"mm"},"å¾®ç±³":{factor:1e6,symbol:"Î¼m"},"çº³ç±³":{factor:1e9,symbol:"nm"},"è‹±é‡Œ":{factor:621371e-9,symbol:"mi"},"ç ":{factor:1.09361,symbol:"yd"},"è‹±å°º":{factor:3.28084,symbol:"ft"},"è‹±å¯¸":{factor:39.3701,symbol:"in"},"æµ·é‡Œ":{factor:539957e-9,symbol:"nmi"},"å…‰å¹´":{factor:1057e-19,symbol:"ly"}}},weight:{name:"é‡é‡",units:{"åƒå…‹":{factor:1,symbol:"kg"},"å…‹":{factor:1e3,symbol:"g"},"æ¯«å…‹":{factor:1e6,symbol:"mg"},"å¨":{factor:.001,symbol:"t"},"ç£…":{factor:2.20462,symbol:"lb"},"ç›å¸":{factor:35.274,symbol:"oz"},"å…‹æ‹‰":{factor:5e3,symbol:"ct"},"æ–¤":{factor:2,symbol:"jin"},"ä¸¤":{factor:20,symbol:"liang"},"é’±":{factor:200,symbol:"qian"}}},temperature:{name:"æ¸©åº¦",units:{"æ‘„æ°åº¦":{convert:t=>t,symbol:"Â°C"},"åæ°åº¦":{convert:t=>9*t/5+32,symbol:"Â°F"},"å¼€å°”æ–‡":{convert:t=>t+273.15,symbol:"K"},"å…°æ°åº¦":{convert:t=>9*(t+273.15)/5,symbol:"Â°R"},"åˆ—æ°åº¦":{convert:t=>4*t/5,symbol:"Â°RÃ©"}}},area:{name:"é¢ç§¯",units:{"å¹³æ–¹ç±³":{factor:1,symbol:"mÂ²"},"å¹³æ–¹åƒç±³":{factor:1e-6,symbol:"kmÂ²"},"å¹³æ–¹å˜ç±³":{factor:1e4,symbol:"cmÂ²"},"å¹³æ–¹æ¯«ç±³":{factor:1e6,symbol:"mmÂ²"},"å…¬é¡·":{factor:1e-4,symbol:"ha"},"äº©":{factor:.0015,symbol:"mu"},"å¹³æ–¹è‹±å°º":{factor:10.7639,symbol:"ftÂ²"},"å¹³æ–¹ç ":{factor:1.19599,symbol:"ydÂ²"},"å¹³æ–¹è‹±é‡Œ":{factor:3.861e-7,symbol:"miÂ²"},"è‹±äº©":{factor:247105e-9,symbol:"acre"}}},volume:{name:"ä½“ç§¯",units:{"ç«‹æ–¹ç±³":{factor:1,symbol:"mÂ³"},"å‡":{factor:1e3,symbol:"L"},"æ¯«å‡":{factor:1e6,symbol:"mL"},"ç«‹æ–¹å˜ç±³":{factor:1e6,symbol:"cmÂ³"},"ç«‹æ–¹æ¯«ç±³":{factor:1e9,symbol:"mmÂ³"},"åŠ ä»‘(ç¾)":{factor:264.172,symbol:"gal"},"åŠ ä»‘(è‹±)":{factor:219.969,symbol:"gal"},"å¤¸è„±(ç¾)":{factor:1056.69,symbol:"qt"},"å“è„±(ç¾)":{factor:2113.38,symbol:"pt"},"æ¶²ç›å¸(ç¾)":{factor:33814,symbol:"fl oz"}}},speed:{name:"é€Ÿåº¦",units:{"ç±³/ç§’":{factor:1,symbol:"m/s"},"åƒç±³/å°æ—¶":{factor:3.6,symbol:"km/h"},"è‹±é‡Œ/å°æ—¶":{factor:2.23694,symbol:"mph"},"è‹±å°º/ç§’":{factor:3.28084,symbol:"ft/s"},"èŠ‚":{factor:1.94384,symbol:"kn"},"é©¬èµ«":{factor:.00291545,symbol:"Ma"},"å…‰é€Ÿ":{factor:3.33564e-9,symbol:"c"}}},time:{name:"æ—¶é—´",units:{"ç§’":{factor:1,symbol:"s"},"æ¯«ç§’":{factor:1e3,symbol:"ms"},"å¾®ç§’":{factor:1e6,symbol:"Î¼s"},"çº³ç§’":{factor:1e9,symbol:"ns"},"åˆ†é’Ÿ":{factor:1/60,symbol:"min"},"å°æ—¶":{factor:1/3600,symbol:"h"},"å¤©":{factor:1/86400,symbol:"day"},"å‘¨":{factor:1/604800,symbol:"week"},"æœˆ":{factor:1/2592e3,symbol:"month"},"å¹´":{factor:1/31536e3,symbol:"year"}}},pressure:{name:"å‹åŠ›",units:{"å¸•æ–¯å¡":{factor:1,symbol:"Pa"},"åƒå¸•":{factor:.001,symbol:"kPa"},"å…†å¸•":{factor:1e-6,symbol:"MPa"},"å·´":{factor:1e-5,symbol:"bar"},"æ¯«å·´":{factor:.01,symbol:"mbar"},"æ ‡å‡†å¤§æ°”å‹":{factor:986923e-11,symbol:"atm"},"æ¯«ç±³æ±æŸ±":{factor:.00750062,symbol:"mmHg"},"ç£…/å¹³æ–¹è‹±å¯¸":{factor:145038e-9,symbol:"psi"},"æ‰˜":{factor:.00750062,symbol:"Torr"}}},energy:{name:"èƒ½é‡",units:{"ç„¦è€³":{factor:1,symbol:"J"},"åƒç„¦":{factor:.001,symbol:"kJ"},"å…†ç„¦":{factor:1e-6,symbol:"MJ"},"å¡è·¯é‡Œ":{factor:.239006,symbol:"cal"},"åƒå¡":{factor:239006e-9,symbol:"kcal"},"åƒç“¦æ—¶":{factor:2.77778e-7,symbol:"kWh"},"è‹±çƒ­å•ä½":{factor:947817e-9,symbol:"BTU"},"ç”µå­ä¼ç‰¹":{factor:6242e15,symbol:"eV"},"å°”æ ¼":{factor:1e7,symbol:"erg"}}},power:{name:"åŠŸç‡",units:{"ç“¦ç‰¹":{factor:1,symbol:"W"},"åƒç“¦":{factor:.001,symbol:"kW"},"å…†ç“¦":{factor:1e-6,symbol:"MW"},"é©¬åŠ›":{factor:.00134102,symbol:"hp"},"è‹±åˆ¶é©¬åŠ›":{factor:.00134102,symbol:"hp"},"å…¬åˆ¶é©¬åŠ›":{factor:.00135962,symbol:"ps"},"å°”æ ¼/ç§’":{factor:1e7,symbol:"erg/s"},"è‹±å°ºÂ·ç£…/ç§’":{factor:.737562,symbol:"ftÂ·lb/s"},"åƒå¡/å°æ—¶":{factor:859845e-9,symbol:"kcal/h"}}},angle:{name:"è§’åº¦",units:{"åº¦":{factor:1,symbol:"Â°"},"å¼§åº¦":{factor:.0174533,symbol:"rad"},"æ¢¯åº¦":{factor:1.11111,symbol:"grad"},"åœˆ":{factor:.00277778,symbol:"turn"},"è§’åˆ†":{factor:60,symbol:"'"},"è§’ç§’":{factor:3600,symbol:'"'}}},data:{name:"æ•°æ®",units:{"å­—èŠ‚":{factor:1,symbol:"B"},"åƒå­—èŠ‚":{factor:.001,symbol:"KB"},"å…†å­—èŠ‚":{factor:1e-6,symbol:"MB"},"å‰å­—èŠ‚":{factor:1e-9,symbol:"GB"},"å¤ªå­—èŠ‚":{factor:1e-12,symbol:"TB"},"æ¯”ç‰¹":{factor:8,symbol:"bit"},"åƒæ¯”ç‰¹":{factor:.008,symbol:"Kbit"},"å…†æ¯”ç‰¹":{factor:8e-6,symbol:"Mbit"},"å‰æ¯”ç‰¹":{factor:8e-9,symbol:"Gbit"}}}},this.currentCategory="length",this.fromUnit="ç±³",this.toUnit="åƒç±³",this.inputValue=1}convert(t,n,e,o){if("temperature"===o){const o=this.toCelsius(t,n);return this.fromCelsius(o,e)}return t/this.categories[o].units[n].factor*this.categories[o].units[e].factor}toCelsius(t,n){return"æ‘„æ°åº¦"===n?t:"åæ°åº¦"===n?5*(t-32)/9:"å¼€å°”æ–‡"===n?t-273.15:"å…°æ°åº¦"===n?5*(t-491.67)/9:"åˆ—æ°åº¦"===n?5*t/4:t}fromCelsius(t,n){return"æ‘„æ°åº¦"===n?t:"åæ°åº¦"===n?9*t/5+32:"å¼€å°”æ–‡"===n?t+273.15:"å…°æ°åº¦"===n?9*(t+273.15)/5:"åˆ—æ°åº¦"===n?4*t/5:t}getUnitSymbol(t,n){return this.categories[n].units[t].symbol}}class EnhancedTimer{constructor(){this.timers=[],this.timerId=0,this.presets={pomodoro:{name:"ç•ªèŒ„å·¥ä½œæ³•",minutes:25,seconds:0},shortBreak:{name:"çŸ­ä¼‘æ¯",minutes:5,seconds:0},longBreak:{name:"é•¿ä¼‘æ¯",minutes:15,seconds:0},quickMeeting:{name:"å¿«é€Ÿä¼šè®®",minutes:10,seconds:0},standardMeeting:{name:"æ ‡å‡†ä¼šè®®",minutes:30,seconds:0},presentation:{name:"æ¼”è®²",minutes:20,seconds:0},exercise:{name:"è¿åŠ¨",minutes:45,seconds:0},meditation:{name:"å†¥æƒ³",minutes:15,seconds:0},reading:{name:"é˜…è¯»",minutes:60,seconds:0},cooking:{name:"çƒ¹é¥ª",minutes:40,seconds:0}}}createTimer(t,n,e){const o=60*n+e,a={id:this.timerId++,name:t,totalSeconds:o,remainingSeconds:o,isRunning:!1,isFinished:!1,interval:null};return this.timers.push(a),a}startTimer(t){const n=this.timers.find(n=>n.id===t);n&&!n.isFinished&&(n.isRunning=!0,n.interval=setInterval(()=>{n.remainingSeconds>0?n.remainingSeconds--:(this.pauseTimer(t),n.isFinished=!0,this.onTimerFinished(n))},1e3))}pauseTimer(t){const n=this.timers.find(n=>n.id===t);n&&(n.isRunning=!1,n.interval&&(clearInterval(n.interval),n.interval=null))}resetTimer(t){const n=this.timers.find(n=>n.id===t);n&&(this.pauseTimer(t),n.remainingSeconds=n.totalSeconds,n.isFinished=!1)}deleteTimer(t){const n=this.timers.findIndex(n=>n.id===t);if(-1===n)return;this.timers[n];this.pauseTimer(t),this.timers.splice(n,1)}formatTime(t){const n=Math.floor(t/3600),e=Math.floor(t%3600/60),o=t%60;return`${n.toString().padStart(2,"0")}:${e.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}onTimerFinished(t){}}class ScientificCalculator{constructor(){this.display="0",this.previousValue=null,this.operation=null,this.waitingForOperand=!1,this.memory=0,this.history=[],this.angleMode="deg",this.maxHistoryItems=20}inputDigit(t){this.waitingForOperand?(this.display=String(t),this.waitingForOperand=!1):this.display="0"===this.display?String(t):this.display+t}inputDecimal(){this.waitingForOperand?(this.display="0.",this.waitingForOperand=!1):-1===this.display.indexOf(".")&&(this.display+=".")}clear(){this.display="0",this.previousValue=null,this.operation=null,this.waitingForOperand=!1}clearAll(){this.clear(),this.memory=0}deleteLastDigit(){const t=this.display;this.display=1===t.length?"0":t.substring(0,t.length-1)}toggleSign(){const t=this.display;this.display="-"===t.charAt(0)?t.substring(1):`-${t}`}inputPercent(){const t=this.display;this.display=String(parseFloat(t)/100)}performOperation(t){const n=parseFloat(this.display);if(null===this.previousValue)this.previousValue=n;else if(this.operation){const t=this.previousValue||0,e=this.calculate(t,n,this.operation);this.display=String(e),this.previousValue=e,this.addToHistory(`${t} ${this.operation} ${n} = ${e}`)}this.waitingForOperand=!0,this.operation=t}calculate(t,n,e){switch(e){case"+":return t+n;case"-":return t-n;case"*":return t*n;case"/":return t/n;default:return n}}calculateSquare(){const t=parseFloat(this.display),n=t*t;this.addToHistory(`sqr(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateSquareRoot(){const t=parseFloat(this.display),n=Math.sqrt(t);this.addToHistory(`âˆš(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateCube(){const t=parseFloat(this.display),n=t*t*t;this.addToHistory(`cube(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateCubeRoot(){const t=parseFloat(this.display),n=Math.cbrt(t);this.addToHistory(`âˆ›(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculatePower(t){const n=parseFloat(this.display),e=Math.pow(n,t);this.addToHistory(`${n}^${t} = ${e}`),this.display=String(e),this.waitingForOperand=!0}calculateReciprocal(){const t=parseFloat(this.display),n=1/t;this.addToHistory(`1/(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateFactorial(){const t=parseInt(this.display);if(t<0)return void(this.display="é”™è¯¯");let n=1;for(let e=2;e<=t;e++)n*=e;this.addToHistory(`${t}! = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateLog(t=10){const n=parseFloat(this.display);if(n<=0)return void(this.display="é”™è¯¯");const e=10===t?Math.log10(n):Math.log(n);this.addToHistory(`log${10===t?"":"e"}(${n}) = ${e}`),this.display=String(e),this.waitingForOperand=!0}calculateLn(){const t=parseFloat(this.display);if(t<=0)return void(this.display="é”™è¯¯");const n=Math.log(t);this.addToHistory(`ln(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateExp(){const t=parseFloat(this.display),n=Math.exp(t);this.addToHistory(`e^(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateSin(){const t=parseFloat(this.display),n="deg"===this.angleMode?t*Math.PI/180:t,e=Math.sin(n);this.addToHistory(`sin${"deg"===this.angleMode?"Â°":""}(${t}) = ${e}`),this.display=String(e),this.waitingForOperand=!0}calculateCos(){const t=parseFloat(this.display),n="deg"===this.angleMode?t*Math.PI/180:t,e=Math.cos(n);this.addToHistory(`cos${"deg"===this.angleMode?"Â°":""}(${t}) = ${e}`),this.display=String(e),this.waitingForOperand=!0}calculateTan(){const t=parseFloat(this.display),n="deg"===this.angleMode?t*Math.PI/180:t,e=Math.tan(n);this.addToHistory(`tan${"deg"===this.angleMode?"Â°":""}(${t}) = ${e}`),this.display=String(e),this.waitingForOperand=!0}calculateASin(){const t=parseFloat(this.display);if(t<-1||t>1)return void(this.display="é”™è¯¯");let n=Math.asin(t);"deg"===this.angleMode&&(n=180*n/Math.PI),this.addToHistory(`asin${"deg"===this.angleMode?"Â°":""}(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateACos(){const t=parseFloat(this.display);if(t<-1||t>1)return void(this.display="é”™è¯¯");let n=Math.acos(t);"deg"===this.angleMode&&(n=180*n/Math.PI),this.addToHistory(`acos${"deg"===this.angleMode?"Â°":""}(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateATan(){const t=parseFloat(this.display);let n=Math.atan(t);"deg"===this.angleMode&&(n=180*n/Math.PI),this.addToHistory(`atan${"deg"===this.angleMode?"Â°":""}(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateSinH(){const t=parseFloat(this.display),n=Math.sinh(t);this.addToHistory(`sinh(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateCosH(){const t=parseFloat(this.display),n=Math.cosh(t);this.addToHistory(`cosh(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}calculateTanH(){const t=parseFloat(this.display),n=Math.tanh(t);this.addToHistory(`tanh(${t}) = ${n}`),this.display=String(n),this.waitingForOperand=!0}toggleAngleMode(){this.angleMode="deg"===this.angleMode?"rad":"deg"}memoryAdd(){this.memory+=parseFloat(this.display)}memorySubtract(){this.memory-=parseFloat(this.display)}memoryRecall(){this.display=String(this.memory),this.waitingForOperand=!0}memoryClear(){this.memory=0}inputPi(){this.display=String(Math.PI),this.waitingForOperand=!0}inputE(){this.display=String(Math.E),this.waitingForOperand=!0}addToHistory(t){this.history.unshift(t),this.history.length>this.maxHistoryItems&&this.history.pop()}getHistory(){return[...this.history]}clearHistory(){this.history=[]}}window.EnhancedUnitConverter=EnhancedUnitConverter,window.EnhancedTimer=EnhancedTimer,window.ScientificCalculator=ScientificCalculator;let enhancedCalculator=null;function openEnhancedCalculator(){showToolModal("ç§‘å­¦è®¡ç®—å™¨",'\n        <div class="calculator-container p-4 bg-gradient-to-br from-gray-50 to-gray-100 rounded-xl shadow-lg">\n            \x3c!-- è®¡ç®—å™¨æ˜¾ç¤ºåŒºåŸŸ --\x3e\n            <div class="calculator-display-container mb-4 rounded-lg overflow-hidden bg-black">\n                <div class="calculator-history text-right p-2 text-gray-400 min-h-[30px]" id="calculatorHistory"></div>\n                <div class="calculator-display text-right p-4 text-white text-3xl font-mono" id="calculatorDisplay">0</div>\n                <div class="calculator-mode flex justify-between p-2 bg-gray-900">\n                    <button id="angleMode" class="text-sm px-3 py-1 bg-blue-700 text-white rounded-full">è§’åº¦: DEG</button>\n                    <button id="memoryIndicator" class="text-sm px-3 py-1 bg-blue-700 text-white rounded-full hidden">M</button>\n                </div>\n            </div>\n            \n            \x3c!-- è®°å¿†åŠŸèƒ½æŒ‰é’® --\x3e\n            <div class="calculator-memory mb-3">\n                <div class="grid grid-cols-5 gap-2">\n                    <button onclick="calculatorAction(\'mc\')" class="calc-btn calc-btn-memory py-2 px-3 rounded-lg text-sm">MC</button>\n                    <button onclick="calculatorAction(\'mr\')" class="calc-btn calc-btn-memory py-2 px-3 rounded-lg text-sm">MR</button>\n                    <button onclick="calculatorAction(\'m+\')" class="calc-btn calc-btn-memory py-2 px-3 rounded-lg text-sm">M+</button>\n                    <button onclick="calculatorAction(\'m-\')" class="calc-btn calc-btn-memory py-2 px-3 rounded-lg text-sm">M-</button>\n                    <button onclick="calculatorAction(\'ms\')" class="calc-btn calc-btn-memory py-2 px-3 rounded-lg text-sm">MS</button>\n                </div>\n            </div>\n            \n            \x3c!-- ç§‘å­¦è®¡ç®—åŠŸèƒ½æŒ‰é’® --\x3e\n            <div class="calculator-scientific mb-3">\n                <div class="grid grid-cols-6 gap-2">\n                    <button onclick="calculatorAction(\'second\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">2nd</button>\n                    <button onclick="calculatorAction(\'pi\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">Ï€</button>\n                    <button onclick="calculatorAction(\'e\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">e</button>\n                    <button onclick="calculatorAction(\'c\')" class="calc-btn calc-btn-clear py-2 rounded-lg">C</button>\n                    <button onclick="calculatorAction(\'ce\')" class="calc-btn calc-btn-clear py-2 rounded-lg">CE</button>\n                    <button onclick="calculatorAction(\'backspace\')" class="calc-btn calc-btn-clear py-2 rounded-lg">âŒ«</button>\n                </div>\n            </div>\n            \n            \x3c!-- æ ¸å¿ƒè®¡ç®—åŒºåŸŸï¼šç§‘å­¦å‡½æ•° + æ•°å­—é”®ç›˜ --\x3e\n            <div id="calculator-main-grid">\n                \x3c!-- ç§‘å­¦å‡½æ•°æŒ‰é’® --\x3e\n                <div class="grid grid-cols-5 gap-2 mb-3">\n                    <button onclick="calculatorAction(\'x2\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">xÂ²</button>\n                    <button onclick="calculatorAction(\'sqrt\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">âˆš</button>\n                    <button onclick="calculatorAction(\'xy\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">xÊ¸</button>\n                    <button onclick="calculatorAction(\'1/x\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">1/x</button>\n                    <button onclick="calculatorAction(\'divide\')" class="calc-btn calc-btn-operator py-2 rounded-lg">Ã·</button>\n                </div>\n                \n                <div class="grid grid-cols-5 gap-2 mb-3">\n                    <button onclick="calculatorAction(\'sin\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">sin</button>\n                    <button onclick="calculatorAction(\'cos\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">cos</button>\n                    <button onclick="calculatorAction(\'tan\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">tan</button>\n                    <button onclick="calculatorAction(\'log\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">log</button>\n                    <button onclick="calculatorAction(\'multiply\')" class="calc-btn calc-btn-operator py-2 rounded-lg">Ã—</button>\n                </div>\n                \n                <div class="grid grid-cols-5 gap-2 mb-3">\n                    <button onclick="calculatorAction(\'asin\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">asin</button>\n                    <button onclick="calculatorAction(\'acos\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">acos</button>\n                    <button onclick="calculatorAction(\'atan\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">atan</button>\n                    <button onclick="calculatorAction(\'ln\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">ln</button>\n                    <button onclick="calculatorAction(\'subtract\')" class="calc-btn calc-btn-operator py-2 rounded-lg">-</button>\n                </div>\n                \n                <div class="grid grid-cols-5 gap-2 mb-3">\n                    <button onclick="calculatorAction(\'factorial\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">n!</button>\n                    <button onclick="calculatorAction(\'sinh\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">sinh</button>\n                    <button onclick="calculatorAction(\'cosh\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">cosh</button>\n                    <button onclick="calculatorAction(\'tanh\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">tanh</button>\n                    <button onclick="calculatorAction(\'add\')" class="calc-btn calc-btn-operator py-2 rounded-lg">+</button>\n                </div>\n                \n                \x3c!-- æ•°å­—é”®ç›˜ --\x3e\n                <div class="grid grid-cols-5 gap-2 mb-3">\n                    <button onclick="calculatorAction(\'7\')" class="calc-btn calc-btn-number py-2 rounded-lg">7</button>\n                    <button onclick="calculatorAction(\'8\')" class="calc-btn calc-btn-number py-2 rounded-lg">8</button>\n                    <button onclick="calculatorAction(\'9\')" class="calc-btn calc-btn-number py-2 rounded-lg">9</button>\n                    <button onclick="calculatorAction(\'leftParen\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">(</button>\n                    <button onclick="calculatorAction(\'rightParen\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">)</button>\n                </div>\n                \n                <div class="grid grid-cols-5 gap-2 mb-3">\n                    <button onclick="calculatorAction(\'4\')" class="calc-btn calc-btn-number py-2 rounded-lg">4</button>\n                    <button onclick="calculatorAction(\'5\')" class="calc-btn calc-btn-number py-2 rounded-lg">5</button>\n                    <button onclick="calculatorAction(\'6\')" class="calc-btn calc-btn-number py-2 rounded-lg">6</button>\n                    <button onclick="calculatorAction(\'percent\')" class="calc-btn calc-btn-scientific py-2 rounded-lg">%</button>\n                    <button onclick="calculatorAction(\'negate\')" class="calc-btn calc-btn-number py-2 rounded-lg">Â±</button>\n                </div>\n                \n                <div class="grid grid-cols-5 gap-2">\n                    <button onclick="calculatorAction(\'1\')" class="calc-btn calc-btn-number py-2 rounded-lg">1</button>\n                    <button onclick="calculatorAction(\'2\')" class="calc-btn calc-btn-number py-2 rounded-lg">2</button>\n                    <button onclick="calculatorAction(\'3\')" class="calc-btn calc-btn-number py-2 rounded-lg">3</button>\n                    <button onclick="calculatorAction(\'0\')" class="calc-btn calc-btn-number py-2 rounded-lg">0</button>\n                    <button onclick="calculatorAction(\'decimal\')" class="calc-btn calc-btn-number py-2 rounded-lg">.</button>\n                </div>\n                \n                \x3c!-- ç­‰å·æŒ‰é’® --\x3e\n                <div class="mt-3">\n                    <button onclick="calculatorAction(\'equals\')" class="calc-btn calc-btn-equals py-3 rounded-lg w-full">=</button>\n                </div>\n            </div>\n        </div>\n    '),enhancedCalculator||(enhancedCalculator=new ScientificCalculator),updateCalculatorDisplay(),updateCalculatorHistory(),updateMemoryIndicator(),updateAngleMode(),document.addEventListener("keydown",handleCalculatorKeyPress)}function calculatorAction(t){switch(enhancedCalculator||(enhancedCalculator=new ScientificCalculator),t){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":enhancedCalculator.inputDigit(parseInt(t));break;case"decimal":enhancedCalculator.inputDecimal();break;case"add":enhancedCalculator.performOperation("+");break;case"subtract":enhancedCalculator.performOperation("-");break;case"multiply":enhancedCalculator.performOperation("*");break;case"divide":enhancedCalculator.performOperation("/");break;case"equals":enhancedCalculator.performOperation("=");break;case"c":enhancedCalculator.clear();break;case"ce":enhancedCalculator.clearAll();break;case"backspace":enhancedCalculator.deleteLastDigit();break;case"x2":enhancedCalculator.calculateSquare();break;case"sqrt":enhancedCalculator.calculateSquareRoot();break;case"cbrt":enhancedCalculator.calculateCubeRoot();break;case"xy":enhancedCalculator.calculatePower(2);break;case"factorial":enhancedCalculator.calculateFactorial();break;case"reciprocal":enhancedCalculator.calculateReciprocal();break;case"log":enhancedCalculator.calculateLog(10);break;case"ln":enhancedCalculator.calculateLn();break;case"exp":enhancedCalculator.calculateExp();break;case"sin":enhancedCalculator.calculateSin();break;case"cos":enhancedCalculator.calculateCos();break;case"tan":enhancedCalculator.calculateTan();break;case"asin":enhancedCalculator.calculateASin();break;case"acos":enhancedCalculator.calculateACos();break;case"atan":enhancedCalculator.calculateATan();break;case"sinh":enhancedCalculator.calculateSinH();break;case"cosh":enhancedCalculator.calculateCosH();break;case"tanh":enhancedCalculator.calculateTanH();break;case"pi":enhancedCalculator.inputPi();break;case"e":enhancedCalculator.inputE();break;case"angleMode":enhancedCalculator.toggleAngleMode(),updateAngleMode();break;case"negate":enhancedCalculator.toggleSign();break;case"percent":enhancedCalculator.inputPercent();break;case"leftParen":enhancedCalculator.inputDigit("(");break;case"rightParen":enhancedCalculator.inputDigit(")");break;case"mc":enhancedCalculator.memoryClear(),updateMemoryIndicator();break;case"mr":enhancedCalculator.memoryRecall();break;case"m+":enhancedCalculator.memoryAdd(),updateMemoryIndicator();break;case"m-":enhancedCalculator.memorySubtract(),updateMemoryIndicator();break;case"ms":enhancedCalculator.memory=parseFloat(enhancedCalculator.display),updateMemoryIndicator()}updateCalculatorDisplay(),updateCalculatorHistory()}function updateCalculatorDisplay(){if(enhancedCalculator){const t=document.getElementById("calculatorDisplay");t&&(t.textContent=enhancedCalculator.display)}}function updateCalculatorHistory(){if(enhancedCalculator){const t=document.getElementById("calculatorHistory");if(t){const n=enhancedCalculator.getHistory();n.length>0?t.textContent=n[0]:t.textContent=""}}}function updateMemoryIndicator(){if(enhancedCalculator){const t=document.getElementById("memoryIndicator");t&&(0!==enhancedCalculator.memory?t.classList.remove("hidden"):t.classList.add("hidden"))}}function updateAngleMode(){if(enhancedCalculator){const t=document.getElementById("angleMode");t&&(t.textContent=`è§’åº¦: ${enhancedCalculator.angleMode.toUpperCase()}`)}}function handleCalculatorKeyPress(t){if(!enhancedCalculator||!document.getElementById("calculatorDisplay"))return;const n=t.key;n>="0"&&n<="9"?calculatorAction(n):"."===n?calculatorAction("decimal"):"+"===n?calculatorAction("add"):"-"===n?calculatorAction("subtract"):"*"===n?calculatorAction("multiply"):"/"===n?(t.preventDefault(),calculatorAction("divide")):"Enter"===n||"="===n?calculatorAction("equals"):"Backspace"===n?calculatorAction("backspace"):"Escape"===n?calculatorAction("c"):"Delete"===n&&calculatorAction("ce")}let enhancedConverter=null;function openEnhancedUnitConverter(){showToolModal("å¢å¼ºå•ä½è½¬æ¢å™¨",'\n        <div class="converter-container">\n            \x3c!-- è½¬æ¢ç±»å‹é€‰æ‹© --\x3e\n            <div class="converter-card">\n                <div class="converter-card-title">\n                    <div class="converter-card-icon">ğŸ“</div>\n                    é€‰æ‹©è½¬æ¢ç±»å‹\n                </div>\n                <div class="converter-tabs" id="converterTabs">\n                    \x3c!-- æ ‡ç­¾å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ --\x3e\n                </div>\n            </div>\n            \n            \x3c!-- è¾“å…¥åŒºåŸŸ --\x3e\n            <div class="converter-card">\n                <div class="converter-card-title">\n                    <div class="converter-card-icon">âœï¸</div>\n                    è¾“å…¥æ•°å€¼\n                </div>\n                <div class="input-group">\n                    <input type="number" id="converterValue" class="converter-input" placeholder="è¾“å…¥è¦è½¬æ¢çš„æ•°å€¼" step="any">\n                    <select id="fromUnit" class="converter-select">\n                        \x3c!-- é€‰é¡¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ --\x3e\n                    </select>\n                    <div style="text-align: center; margin: 1rem 0; color: #6200EE; font-weight: bold;">\n                        <svg width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">\n                            <path d="M5 12h14"></path>\n                            <polyline points="12 5 19 12 12 19"></polyline>\n                        </svg>\n                    </div>\n                    <select id="toUnit" class="converter-select">\n                        \x3c!-- é€‰é¡¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ --\x3e\n                    </select>\n                    <button id="convertBtn" class="converter-btn">è½¬æ¢</button>\n                </div>\n            </div>\n            \n            \x3c!-- ç»“æœæ˜¾ç¤º --\x3e\n            <div class="converter-card">\n                <div class="converter-card-title">\n                    <div class="converter-card-icon">ğŸ“Š</div>\n                    è½¬æ¢ç»“æœ\n                </div>\n                <div class="result-display">\n                    <div class="result-value" id="converterResult">è¯·è¾“å…¥æ•°å€¼å¹¶é€‰æ‹©å•ä½</div>\n                    <div class="result-formula" id="resultFormula"></div>\n                    <div class="result-ratio" id="resultRatio"></div>\n                </div>\n            </div>\n            \n            \x3c!-- å¸¸ç”¨è½¬æ¢å¿«æ·æ–¹å¼ --\x3e\n            <div class="converter-card">\n                <div class="converter-card-title">\n                    <div class="converter-card-icon">âš¡</div>\n                    å¸¸ç”¨è½¬æ¢\n                </div>\n                <div class="quick-convert-grid" id="quickConvert">\n                    \x3c!-- å¿«æ·è½¬æ¢æŒ‰é’®å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ --\x3e\n                </div>\n            </div>\n            \n            \x3c!-- è½¬æ¢å†å² --\x3e\n            <div class="converter-card">\n                <div class="converter-card-title">\n                    <div class="converter-card-icon">ğŸ“œ</div>\n                    è½¬æ¢å†å²\n                </div>\n                <div class="converter-history" id="converterHistory">\n                    \x3c!-- å†å²è®°å½•å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ --\x3e\n                </div>\n            </div>\n        </div>\n    '),initEnhancedConverter(),document.getElementById("convertBtn").addEventListener("click",performEnhancedConversion),document.getElementById("converterValue").addEventListener("input",performEnhancedConversion),document.getElementById("fromUnit").addEventListener("change",performEnhancedConversion),document.getElementById("toUnit").addEventListener("change",performEnhancedConversion)}function initEnhancedConverter(){const t=new EnhancedUnitConverter;window.currentConverter=t;const n=document.getElementById("converterTabs");Object.keys(t.categories).forEach(e=>{const o=document.createElement("button");o.className="converter-tab",o.textContent=t.categories[e].name,o.dataset.category=e,"length"===e&&o.classList.add("active"),o.addEventListener("click",function(){document.querySelectorAll(".converter-tab").forEach(t=>t.classList.remove("active")),this.classList.add("active"),updateUnitOptions(e),updateQuickConvertButtons(e)}),n.appendChild(o)}),updateUnitOptions("length"),updateQuickConvertButtons("length")}function updateUnitOptions(t){window.currentConverter||(window.currentConverter=new EnhancedUnitConverter);const n=window.currentConverter,e=document.getElementById("fromUnit"),o=document.getElementById("toUnit");e.innerHTML="",o.innerHTML="";try{const a=n.categories[t].units;Object.keys(a).forEach(t=>{const n=document.createElement("option");n.value=t;const c=a[t].symbol||"";n.textContent=c?`${t} (${c})`:t,e.appendChild(n);const i=document.createElement("option");i.value=t,i.textContent=c?`${t} (${c})`:t,o.appendChild(i)}),o.options.length>1&&(o.selectedIndex=1),performEnhancedConversion()}catch(t){e.innerHTML='<option value="">åŠ è½½å•ä½å¤±è´¥</option>',o.innerHTML='<option value="">åŠ è½½å•ä½å¤±è´¥</option>'}}function updateQuickConvertButtons(t){const n=document.getElementById("quickConvert");n.innerHTML="";const e={length:[{from:"ç±³",to:"åƒç±³"},{from:"åƒç±³",to:"ç±³"},{from:"å˜ç±³",to:"ç±³"},{from:"ç±³",to:"å˜ç±³"},{from:"æ¯«ç±³",to:"å˜ç±³"},{from:"å˜ç±³",to:"æ¯«ç±³"}],weight:[{from:"å…‹",to:"åƒå…‹"},{from:"åƒå…‹",to:"å…‹"},{from:"æ¯«å…‹",to:"å…‹"},{from:"å…‹",to:"æ¯«å…‹"},{from:"å¨",to:"åƒå…‹"},{from:"åƒå…‹",to:"å¨"}],temperature:[{from:"æ‘„æ°åº¦",to:"åæ°åº¦"},{from:"åæ°åº¦",to:"æ‘„æ°åº¦"},{from:"æ‘„æ°åº¦",to:"å¼€å°”æ–‡"},{from:"å¼€å°”æ–‡",to:"æ‘„æ°åº¦"}],area:[{from:"å¹³æ–¹ç±³",to:"å¹³æ–¹åƒç±³"},{from:"å¹³æ–¹åƒç±³",to:"å¹³æ–¹ç±³"},{from:"å¹³æ–¹å˜ç±³",to:"å¹³æ–¹ç±³"},{from:"å¹³æ–¹ç±³",to:"å¹³æ–¹å˜ç±³"}],volume:[{from:"å‡",to:"æ¯«å‡"},{from:"æ¯«å‡",to:"å‡"},{from:"ç«‹æ–¹ç±³",to:"å‡"},{from:"å‡",to:"ç«‹æ–¹ç±³"}],speed:[{from:"ç±³/ç§’",to:"åƒç±³/å°æ—¶"},{from:"åƒç±³/å°æ—¶",to:"ç±³/ç§’"},{from:"åƒç±³/å°æ—¶",to:"è‹±é‡Œ/å°æ—¶"},{from:"è‹±é‡Œ/å°æ—¶",to:"åƒç±³/å°æ—¶"}],time:[{from:"ç§’",to:"åˆ†é’Ÿ"},{from:"åˆ†é’Ÿ",to:"å°æ—¶"},{from:"å°æ—¶",to:"å¤©"},{from:"å¤©",to:"å‘¨"}],pressure:[{from:"å¸•æ–¯å¡",to:"åƒå¸•"},{from:"åƒå¸•",to:"å…†å¸•"},{from:"å¤§æ°”å‹",to:"åƒå¸•"},{from:"åƒå¸•",to:"å¤§æ°”å‹"}],energy:[{from:"ç„¦è€³",to:"åƒç„¦"},{from:"åƒç„¦",to:"å…†ç„¦"},{from:"å¡è·¯é‡Œ",to:"ç„¦è€³"},{from:"ç„¦è€³",to:"å¡è·¯é‡Œ"}],power:[{from:"ç“¦ç‰¹",to:"åƒç“¦"},{from:"åƒç“¦",to:"å…†ç“¦"},{from:"é©¬åŠ›",to:"åƒç“¦"},{from:"åƒç“¦",to:"é©¬åŠ›"}],angle:[{from:"åº¦",to:"å¼§åº¦"},{from:"å¼§åº¦",to:"åº¦"},{from:"åº¦",to:"æ¢¯åº¦"},{from:"æ¢¯åº¦",to:"åº¦"}],data:[{from:"å­—èŠ‚",to:"åƒå­—èŠ‚"},{from:"åƒå­—èŠ‚",to:"å…†å­—èŠ‚"},{from:"å…†å­—èŠ‚",to:"å‰å­—èŠ‚"},{from:"å‰å­—èŠ‚",to:"å¤ªå­—èŠ‚"}]}[t]||[];window.currentConverter||(window.currentConverter=new EnhancedUnitConverter);const o=window.currentConverter;e.forEach(e=>{const a=document.createElement("button");a.className="quick-convert-btn";let c="",i="";try{o.categories[t]&&o.categories[t].units[e.from]&&(c=o.categories[t].units[e.from].symbol),o.categories[t]&&o.categories[t].units[e.to]&&(i=o.categories[t].units[e.to].symbol)}catch(t){}c||(c=""),i||(i="");const r=c?`${e.from} (${c})`:e.from,s=i?`${e.to} (${i})`:e.to;a.textContent=`${r} â†’ ${s}`,a.addEventListener("click",function(){document.getElementById("fromUnit").value=e.from,document.getElementById("toUnit").value=e.to,document.getElementById("converterValue").value=1,performEnhancedConversion()}),n.appendChild(a)})}function performEnhancedConversion(){const t=parseFloat(document.getElementById("converterValue").value),n=document.getElementById("fromUnit").value,e=document.getElementById("toUnit").value,o=document.querySelector(".converter-tab.active"),a=o?o.dataset.category:"length";if(isNaN(t))return document.getElementById("converterResult").textContent="è¯·è¾“å…¥æœ‰æ•ˆæ•°å€¼",document.getElementById("resultFormula").textContent="",void(document.getElementById("resultRatio").textContent="");window.currentConverter||(window.currentConverter=new EnhancedUnitConverter);const c=window.currentConverter;try{const o=c.convert(t,n,e,a);let i="",r="";try{c.categories[a]&&c.categories[a].units[e]&&(i=c.categories[a].units[e].symbol),c.categories[a]&&c.categories[a].units[n]&&(r=c.categories[a].units[n].symbol)}catch(t){}i||(i=""),r||(r="");const s=i?`${e} (${i})`:e;document.getElementById("converterResult").textContent=`${o.toFixed(6).replace(/\.?0+$/,"")} ${s}`;const l=c.categories[a].units[n].factor,d=l/c.categories[a].units[e].factor,u=r?`${n} (${r})`:n;document.getElementById("resultFormula").textContent=`${t} ${u} = ${t} Ã— ${d.toFixed(6).replace(/\.?0+$/,"")} ${s}`,document.getElementById("resultRatio").textContent=`1 ${u} = ${d.toFixed(6).replace(/\.?0+$/,"")} ${s}`,addToConversionHistory(t,n,o,e)}catch(t){document.getElementById("converterResult").textContent="è½¬æ¢å‡ºé”™ï¼Œè¯·æ£€æŸ¥è¾“å…¥",document.getElementById("resultFormula").textContent="",document.getElementById("resultRatio").textContent=""}}function addToConversionHistory(t,n,e,o){const a=document.getElementById("converterHistory"),c=document.querySelector(".converter-tab.active"),i=c?c.dataset.category:"length";window.currentConverter||(window.currentConverter=new EnhancedUnitConverter);const r=window.currentConverter;let s="",l="";try{r.categories[i]&&r.categories[i].units[n]&&(s=r.categories[i].units[n].symbol),r.categories[i]&&r.categories[i].units[o]&&(l=r.categories[i].units[o].symbol)}catch(t){}s||(s=""),l||(l="");const d=document.createElement("div");d.className="converter-history-item";const u=s?`${n} (${s})`:n,m=l?`${o} (${l})`:o;for(d.textContent=`${t} ${u} = ${e.toFixed(6).replace(/\.?0+$/,"")} ${m}`,d.addEventListener("click",function(){document.getElementById("converterValue").value=t,document.getElementById("fromUnit").value=n,document.getElementById("toUnit").value=o,performEnhancedConversion()}),a.firstChild?a.insertBefore(d,a.firstChild):a.appendChild(d);a.children.length>10;)a.removeChild(a.lastChild)}function quickConvert(t,n,e){const o=document.querySelector(`[data-category="${t}"]`);o&&o.click(),document.getElementById("fromUnit").value=n,document.getElementById("toUnit").value=e,document.getElementById("converterValue").value=1,performEnhancedConversion()}let enhancedCountdown,enhancedCountdownInterval,enhancedTimer=null;function openEnhancedTimer(){showToolModal("å¤šåŠŸèƒ½å€’è®¡æ—¶å™¨",'\n        <div class="timer-container">\n            \x3c!-- é¢„è®¾æ¨¡å¼é€‰æ‹© --\x3e\n            <div class="mb-4">\n                <label class="block text-sm font-medium text-gray-700 mb-2">é€‰æ‹©é¢„è®¾æ¨¡å¼</label>\n                <div class="grid grid-cols-2 gap-2">\n                    <button onclick="setTimerPreset(\'pomodoro\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">ç•ªèŒ„å·¥ä½œæ³• (25åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'shortBreak\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">çŸ­ä¼‘æ¯ (5åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'longBreak\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">é•¿ä¼‘æ¯ (15åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'quickMeeting\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">å¿«é€Ÿä¼šè®® (10åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'standardMeeting\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">æ ‡å‡†ä¼šè®® (30åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'presentation\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">æ¼”è®² (20åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'exercise\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">è¿åŠ¨ (45åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'meditation\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">å†¥æƒ³ (15åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'reading\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">é˜…è¯» (60åˆ†é’Ÿ)</button>\n                    <button onclick="setTimerPreset(\'cooking\')" class="p-2 bg-gray-100 rounded text-sm hover:bg-gray-200">çƒ¹é¥ª (40åˆ†é’Ÿ)</button>\n                </div>\n            </div>\n            \n            \x3c!-- è‡ªå®šä¹‰æ—¶é—´è®¾ç½® --\x3e\n            <div class="mb-4">\n                <label class="block text-sm font-medium text-gray-700 mb-2">è‡ªå®šä¹‰æ—¶é—´</label>\n                <div class="flex items-center space-x-2">\n                    <input type="number" id="customHours" class="w-20 p-2 border border-gray-300 rounded-lg" min="0" max="23" value="0">\n                    <span>å°æ—¶</span>\n                    <input type="number" id="customMinutes" class="w-20 p-2 border border-gray-300 rounded-lg" min="0" max="59" value="0">\n                    <span>åˆ†é’Ÿ</span>\n                    <input type="number" id="customSeconds" class="w-20 p-2 border border-gray-300 rounded-lg" min="0" max="59" value="0">\n                    <span>ç§’</span>\n                </div>\n            </div>\n            \n            \x3c!-- è®¡æ—¶å™¨åç§° --\x3e\n            <div class="mb-4">\n                <label class="block text-sm font-medium text-gray-700 mb-2">è®¡æ—¶å™¨åç§°</label>\n                <input type="text" id="timerName" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="è¾“å…¥è®¡æ—¶å™¨åç§°...">\n            </div>\n            \n            \x3c!-- åˆ›å»ºè®¡æ—¶å™¨æŒ‰é’® --\x3e\n            <button onclick="createEnhancedTimer()" class="w-full p-2 bg-primary text-white rounded-lg hover:bg-primary/90 transition-colors mb-4">\n                åˆ›å»ºè®¡æ—¶å™¨\n            </button>\n            \n            \x3c!-- æ´»åŠ¨è®¡æ—¶å™¨åˆ—è¡¨ --\x3e\n            <div class="mb-4">\n                <h4 class="text-sm font-medium text-gray-700 mb-2">æ´»åŠ¨è®¡æ—¶å™¨</h4>\n                <div id="activeTimers" class="space-y-2">\n                    <div class="text-gray-400 text-center p-4 bg-gray-50 rounded-lg">\n                        æš‚æ— æ´»åŠ¨è®¡æ—¶å™¨\n                    </div>\n                </div>\n            </div>\n        </div>\n    '),enhancedTimer||(enhancedTimer=new EnhancedTimer)}function setTimerPreset(t){enhancedTimer||(enhancedTimer=new EnhancedTimer);const n=enhancedTimer.presets[t];n&&(document.getElementById("customHours").value=Math.floor(n.minutes/60),document.getElementById("customMinutes").value=n.minutes%60,document.getElementById("customSeconds").value=n.seconds,document.getElementById("timerName").value=n.name)}function createEnhancedTimer(){enhancedTimer||(enhancedTimer=new EnhancedTimer);const t=parseInt(document.getElementById("customHours").value)||0,n=parseInt(document.getElementById("customMinutes").value)||0,e=parseInt(document.getElementById("customSeconds").value)||0,o=document.getElementById("timerName").value||`è®¡æ—¶å™¨ ${enhancedTimer.timerId+1}`;if(0===t&&0===n&&0===e)return void alert("è¯·è®¾ç½®è®¡æ—¶æ—¶é—´");enhancedTimer.createTimer(o,n+60*t,e);updateTimerList()}function updateTimerList(){enhancedTimer||(enhancedTimer=new EnhancedTimer);const t=document.getElementById("activeTimers");0!==enhancedTimer.timers.length?(t.innerHTML="",enhancedTimer.timers.forEach(n=>{const e=document.createElement("div");e.className="p-3 bg-gray-50 rounded-lg";const o=enhancedTimer.formatTime(n.remainingSeconds),a=n.isFinished?"å·²å®Œæˆ":n.isRunning?"è¿è¡Œä¸­":"å·²æš‚åœ",c=n.isFinished?"text-green-600":n.isRunning?"text-blue-600":"text-gray-600";e.innerHTML=`\n            <div class="flex justify-between items-center mb-2">\n                <div class="font-medium">${n.name}</div>\n                <div class="${c} text-sm">${a}</div>\n            </div>\n            <div class="text-2xl font-mono text-center mb-2">${o}</div>\n            <div class="flex space-x-2">\n                ${n.isFinished?"":`\n                    <button onclick="startEnhancedTimer(${n.id})" class="flex-1 p-1 bg-blue-500 text-white rounded text-sm hover:bg-blue-600">\n                        ${n.isRunning?"æš‚åœ":"å¼€å§‹"}\n                    </button>\n                    <button onclick="resetEnhancedTimer(${n.id})" class="flex-1 p-1 bg-gray-500 text-white rounded text-sm hover:bg-gray-600">\n                        é‡ç½®\n                    </button>\n                `}\n                <button onclick="deleteEnhancedTimer(${n.id})" class="flex-1 p-1 bg-red-500 text-white rounded text-sm hover:bg-red-600">\n                    åˆ é™¤\n                </button>\n            </div>\n        `,t.appendChild(e)})):t.innerHTML='\n            <div class="text-gray-400 text-center p-4 bg-gray-50 rounded-lg">\n                æš‚æ— æ´»åŠ¨è®¡æ—¶å™¨\n            </div>\n        '}function startEnhancedTimer(t){enhancedTimer||(enhancedTimer=new EnhancedTimer);const n=enhancedTimer.timers.find(n=>n.id===t);n&&(n.isRunning?enhancedTimer.pauseTimer(t):(enhancedTimer.startTimer(t),updateTimerDisplay(t)),updateTimerList())}function resetEnhancedTimer(t){enhancedTimer||(enhancedTimer=new EnhancedTimer),enhancedTimer.resetTimer(t),updateTimerList()}function deleteEnhancedTimer(t){enhancedTimer||(enhancedTimer=new EnhancedTimer),enhancedTimer.deleteTimer(t),updateTimerList()}function updateTimerDisplay(t){enhancedTimer||(enhancedTimer=new EnhancedTimer);const n=enhancedTimer.timers.find(n=>n.id===t);n&&n.isRunning&&(updateTimerList(),n.isRunning&&setTimeout(()=>updateTimerDisplay(t),1e3))}function openEnhancedCountdown(){showToolModal("å¢å¼ºå€’è®¡æ—¶å™¨",'\n        <div class="space-y-4">\n            \x3c!-- å€’è®¡æ—¶æ˜¾ç¤º --\x3e\n            <div class="text-center p-6 bg-gray-100 rounded-lg">\n                <div id="countdownDisplay" class="text-4xl font-mono font-bold text-primary mb-2">00:00:00</div>\n                <div id="countdownName" class="text-lg text-gray-600">æœªå‘½åå€’è®¡æ—¶</div>\n                <div id="countdownProgress" class="w-full bg-gray-200 rounded-full h-2 mt-4">\n                    <div id="countdownProgressBar" class="bg-primary h-2 rounded-full" style="width: 0%"></div>\n                </div>\n            </div>\n            \n            \x3c!-- é¢„è®¾å€’è®¡æ—¶ --\x3e\n            <div class="grid grid-cols-2 gap-2">\n                <button onclick="setCountdownPreset(\'pomodoro\')" class="p-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200">\n                    ç•ªèŒ„é’Ÿ (25åˆ†é’Ÿ)\n                </button>\n                <button onclick="setCountdownPreset(\'shortBreak\')" class="p-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200">\n                    çŸ­ä¼‘æ¯ (5åˆ†é’Ÿ)\n                </button>\n                <button onclick="setCountdownPreset(\'longBreak\')" class="p-2 bg-blue-100 text-blue-700 rounded-lg hover:bg-blue-200">\n                    é•¿ä¼‘æ¯ (15åˆ†é’Ÿ)\n                </button>\n                <button onclick="setCountdownPreset(\'meeting\')" class="p-2 bg-purple-100 text-purple-700 rounded-lg hover:bg-purple-200">\n                    ä¼šè®® (60åˆ†é’Ÿ)\n                </button>\n            </div>\n            \n            \x3c!-- è‡ªå®šä¹‰å€’è®¡æ—¶ --\x3e\n            <div class="border-t pt-4">\n                <h4 class="text-sm font-medium text-gray-700 mb-2">è‡ªå®šä¹‰å€’è®¡æ—¶</h4>\n                <div class="flex justify-center items-center space-x-2 mb-4">\n                    <input type="number" id="countdownHours" class="w-16 p-2 border border-gray-300 rounded-lg text-center" min="0" max="23" value="0">\n                    <span>å°æ—¶</span>\n                    <input type="number" id="countdownMinutes" class="w-16 p-2 border border-gray-300 rounded-lg text-center" min="0" max="59" value="0">\n                    <span>åˆ†é’Ÿ</span>\n                    <input type="number" id="countdownSeconds" class="w-16 p-2 border border-gray-300 rounded-lg text-center" min="0" max="59" value="0">\n                    <span>ç§’</span>\n                </div>\n                \n                \x3c!-- å€’è®¡æ—¶åç§° --\x3e\n                <div class="mb-4">\n                    <label class="block text-sm font-medium text-gray-700 mb-2">å€’è®¡æ—¶åç§°</label>\n                    <input type="text" id="countdownNameInput" class="w-full p-2 border border-gray-300 rounded-lg" placeholder="è¾“å…¥å€’è®¡æ—¶åç§°...">\n                </div>\n            </div>\n            \n            \x3c!-- æ§åˆ¶æŒ‰é’® --\x3e\n            <div class="flex space-x-2">\n                <button id="startCountdownBtn" onclick="startCountdown()" class="flex-1 p-2 bg-green-500 text-white rounded-lg hover:bg-green-600">\n                    å¼€å§‹\n                </button>\n                <button id="pauseCountdownBtn" onclick="pauseCountdown()" class="flex-1 p-2 bg-yellow-500 text-white rounded-lg hover:bg-yellow-600" disabled>\n                    æš‚åœ\n                </button>\n                <button onclick="resetCountdown()" class="flex-1 p-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600">\n                    é‡ç½®\n                </button>\n            </div>\n            \n            \x3c!-- é€šçŸ¥è®¾ç½® --\x3e\n            <div class="border-t pt-4">\n                <h4 class="text-sm font-medium text-gray-700 mb-2">é€šçŸ¥è®¾ç½®</h4>\n                <div class="flex items-center">\n                    <input type="checkbox" id="enableSound" class="mr-2" checked>\n                    <label for="enableSound" class="text-sm">æ’­æ”¾å£°éŸ³æé†’</label>\n                </div>\n                <div class="flex items-center mt-2">\n                    <input type="checkbox" id="enableNotification" class="mr-2" checked>\n                    <label for="enableNotification" class="text-sm">æµè§ˆå™¨é€šçŸ¥</label>\n                </div>\n            </div>\n        </div>\n    '),enhancedCountdown||(enhancedCountdown={totalSeconds:0,remainingSeconds:0,isRunning:!1,presets:{pomodoro:{name:"ç•ªèŒ„é’Ÿ",minutes:25,seconds:0},shortBreak:{name:"çŸ­ä¼‘æ¯",minutes:5,seconds:0},longBreak:{name:"é•¿ä¼‘æ¯",minutes:15,seconds:0},meeting:{name:"ä¼šè®®",minutes:60,seconds:0}}}),"Notification"in window&&"default"===Notification.permission&&Notification.requestPermission()}function setCountdownPreset(t){const n=enhancedCountdown.presets[t];n&&(document.getElementById("countdownHours").value=Math.floor(n.minutes/60),document.getElementById("countdownMinutes").value=n.minutes%60,document.getElementById("countdownSeconds").value=n.seconds,document.getElementById("countdownNameInput").value=n.name)}function startCountdown(){const t=parseInt(document.getElementById("countdownHours").value)||0,n=parseInt(document.getElementById("countdownMinutes").value)||0,e=parseInt(document.getElementById("countdownSeconds").value)||0,o=document.getElementById("countdownNameInput").value||"å€’è®¡æ—¶";enhancedCountdown.isRunning||0!==enhancedCountdown.remainingSeconds||(enhancedCountdown.totalSeconds=3600*t+60*n+e,enhancedCountdown.remainingSeconds=enhancedCountdown.totalSeconds),enhancedCountdown.remainingSeconds<=0?alert("è¯·è®¾ç½®æœ‰æ•ˆçš„å€’è®¡æ—¶æ—¶é—´"):(enhancedCountdown.isRunning=!0,document.getElementById("startCountdownBtn").disabled=!0,document.getElementById("pauseCountdownBtn").disabled=!1,document.getElementById("countdownHours").disabled=!0,document.getElementById("countdownMinutes").disabled=!0,document.getElementById("countdownSeconds").disabled=!0,document.getElementById("countdownNameInput").disabled=!0,document.getElementById("countdownName").textContent=o,enhancedCountdownInterval=setInterval(()=>{enhancedCountdown.remainingSeconds--,updateCountdownDisplay(),enhancedCountdown.remainingSeconds<=0&&completeCountdown()},1e3),updateCountdownDisplay())}function pauseCountdown(){enhancedCountdown.isRunning=!1,clearInterval(enhancedCountdownInterval),document.getElementById("startCountdownBtn").disabled=!1,document.getElementById("pauseCountdownBtn").disabled=!0}function resetCountdown(){enhancedCountdown.isRunning=!1,enhancedCountdown.remainingSeconds=0,enhancedCountdown.totalSeconds=0,clearInterval(enhancedCountdownInterval),document.getElementById("startCountdownBtn").disabled=!1,document.getElementById("pauseCountdownBtn").disabled=!0,document.getElementById("countdownHours").disabled=!1,document.getElementById("countdownMinutes").disabled=!1,document.getElementById("countdownSeconds").disabled=!1,document.getElementById("countdownNameInput").disabled=!1,document.getElementById("countdownDisplay").textContent="00:00:00",document.getElementById("countdownName").textContent="æœªå‘½åå€’è®¡æ—¶",document.getElementById("countdownProgressBar").style.width="0%"}function completeCountdown(){enhancedCountdown.isRunning=!1,clearInterval(enhancedCountdownInterval),document.getElementById("countdownDisplay").textContent="00:00:00",document.getElementById("countdownDisplay").classList.add("text-red-600"),document.getElementById("enableSound").checked&&playNotificationSound(),document.getElementById("enableNotification").checked&&"Notification"in window&&"granted"===Notification.permission&&new Notification("å€’è®¡æ—¶å®Œæˆ",{body:document.getElementById("countdownName").textContent+" å·²å®Œæˆï¼",icon:"/favicon.ico"}),document.getElementById("startCountdownBtn").disabled=!1,document.getElementById("pauseCountdownBtn").disabled=!0}function updateCountdownDisplay(){const t=Math.floor(enhancedCountdown.remainingSeconds/3600),n=Math.floor(enhancedCountdown.remainingSeconds%3600/60),e=enhancedCountdown.remainingSeconds%60,o=String(t).padStart(2,"0")+":"+String(n).padStart(2,"0")+":"+String(e).padStart(2,"0");document.getElementById("countdownDisplay").textContent=o,document.getElementById("countdownDisplay").classList.remove("text-red-600");const a=enhancedCountdown.totalSeconds>0?(enhancedCountdown.totalSeconds-enhancedCountdown.remainingSeconds)/enhancedCountdown.totalSeconds*100:0;document.getElementById("countdownProgressBar").style.width=a+"%"}function playNotificationSound(){const t=new(window.AudioContext||window.webkitAudioContext),n=t.createOscillator(),e=t.createGain();n.connect(e),e.connect(t.destination),n.frequency.value=800,n.type="sine",e.gain.setValueAtTime(.3,t.currentTime),e.gain.exponentialRampToValueAtTime(.01,t.currentTime+.5),n.start(t.currentTime),n.stop(t.currentTime+.5)}window.openEnhancedCalculator=openEnhancedCalculator,window.openEnhancedUnitConverter=openEnhancedUnitConverter,window.openEnhancedTimer=openEnhancedTimer,window.openEnhancedCountdown=openEnhancedCountdown,window.calculatorAction=calculatorAction,window.initEnhancedConverter=initEnhancedConverter,window.updateUnitOptions=updateUnitOptions,window.updateQuickConvertButtons=updateQuickConvertButtons,window.performEnhancedConversion=performEnhancedConversion,window.addToConversionHistory=addToConversionHistory,window.quickConvert=quickConvert,window.setTimerPreset=setTimerPreset,window.createEnhancedTimer=createEnhancedTimer,window.startEnhancedTimer=startEnhancedTimer,window.resetEnhancedTimer=resetEnhancedTimer,window.deleteEnhancedTimer=deleteEnhancedTimer,window.setCountdownPreset=setCountdownPreset,window.startCountdown=startCountdown,window.pauseCountdown=pauseCountdown,window.resetCountdown=resetCountdown;